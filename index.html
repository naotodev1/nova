<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Facilita+ - Assistente Digital Acessível</title>
    <meta name="description" content="Facilita+ - Assistente digital especializada para pessoas 60+, PCDs e iniciantes em tecnologia">
    <meta name="keywords" content="assistente digital, acessibilidade, 60+, idosos, tecnologia, chatbot">
    <meta name="author" content="ORPHEO Platforms">
    <meta name="theme-color" content="
#4F46E5">

    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json,{%22name%22:%22Facilita+%20-%20Assistente%20Digital%20Acessível%22,%22short_name%22:%22Facilita+%22,%22description%22:%22Assistente%20Digital%20Especializada%20para%2060+%22,%22start_url%22:%22/%22,%22display%22:%22standalone%22,%22theme_color%22:%22%234F46E5%22,%22background_color%22:%22%23ffffff%22,%22icons%22:[{%22src%22:%22data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 192 192' fill='%234F46E5'%3E%3Cpath d='M48 96h8M96 96h8M144 96h8M192 96c0 53-43 96-96 96-18.5 0-35.8-5.2-50.4-14.3L16 192l14.3-29.6C21.2 147.8 16 130.5 16 96 16 43 59 0 96 0s96 43 96 96z'/%3E%3C/svg%3E%22,%22sizes%22:%22192x192%22,%22type%22:%22image/svg+xml%22}]}">

    <!-- Favicons -->
    <link rel="icon" type="image/png+xml" href="data:image/png+xml,%3Csvg xmlns='https://i.imgur.com/tTkjOO6.png' viewBox='0 0 24 24' fill='%234F46E5'%3E%3Cpath d='M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z'/%3E%3C/svg%3E">

    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>

    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">

    <style>
        :root {
            --primary-blue: 
#4F46E5;
            --primary-purple: 
#7C3AED;
            --success-green: 
#10B981;
            --warning-orange: 
#F59E0B;
            --danger-red: 
#EF4444;
            --text-size-multiplier: 1;
        }

{
  font-family: 'Inter', system-ui, -apple-system, sans-serif;
}

/* Accessibility Controls */
.text-size-small { --text-size-multiplier: 0.9; }
.text-size-normal { --text-size-multiplier: 1; }
.text-size-large { --text-size-multiplier: 1.2; }
.text-size-xlarge { --text-size-multiplier: 1.5; }

.text-xs { font-size: calc(0.75rem * var(--text-size-multiplier)); }
.text-sm { font-size: calc(0.875rem * var(--text-size-multiplier)); }
.text-base { font-size: calc(1rem * var(--text-size-multiplier)); }
.text-lg { font-size: calc(1.125rem * var(--text-size-multiplier)); }
.text-xl { font-size: calc(1.25rem * var(--text-size-multiplier)); }
.text-2xl { font-size: calc(1.5rem * var(--text-size-multiplier)); }
.text-3xl { font-size: calc(1.875rem * var(--text-size-multiplier)); }
.text-4xl { font-size: calc(2.25rem * var(--text-size-multiplier)); }
.text-5xl { font-size: calc(3rem * var(--text-size-multiplier)); }
.text-6xl { font-size: calc(3.75rem * var(--text-size-multiplier)); }

/* Accessibility Themes */
.high-contrast {
  --bg-primary: 
#000000;
  --text-primary: 
#ffffff;
  --bg-secondary: 
#ffffff;
  --text-secondary: 
#000000;
  --border-color: 
#ffffff;
}

.high-contrast * {
  background-color: var(--bg-primary) !important;
  color: var(--text-primary) !important;
  border-color: var(--border-color) !important;
}

.high-contrast button, .high-contrast .bg-white {
  background-color: var(--bg-secondary) !important;
  color: var(--text-secondary) !important;
  border: 3px solid var(--border-color) !important;
}

.night-mode {
  background: 
#1a202c !important;
  color: 
#e2e8f0 !important;
}

.night-mode .bg-white {
  background: 
#2d3748 !important;
  color: 
#e2e8f0 !important;
}

.reading-mode {
  background: 
#f8f9fa !important;
  color: 
#2d3748 !important;
  line-height: 1.8 !important;
  font-family: Georgia, serif !important;
}

/* Animations */
@media (prefers-reduced-motion: reduce) {
  *, *::before, *::after {
      animation-duration: 0.01ms !important;
      animation-iteration-count: 1 !important;
      transition-duration: 0.01ms !important;
      scroll-behavior: auto !important;
  }
}

.chat-message {
  animation: slideIn 0.3s ease-out;
}

@keyframes slideIn {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}

.voice-pulse {
  animation: voicePulse 1s ease-in-out infinite;
}

@keyframes voicePulse {
  0% { transform: scale(1); }
  50% { transform: scale(1.1); }
  100% { transform: scale(1); }
}

.emergency-button {
  animation: emergencyPulse 2s ease-in-out infinite;
  box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
}

@keyframes emergencyPulse {
  0%, 100% { 
      transform: scale(1);
      box-shadow: 0 0 20px rgba(239, 68, 68, 0.5);
  }
  50% { 
      transform: scale(1.02);
      box-shadow: 0 0 30px rgba(239, 68, 68, 0.8);
  }
}

.loading {
  position: relative;
  overflow: hidden;
}

.loading::after {
  content: '';
  position: absolute;
  top: 0;
  left: -100%;
  width: 100%;
  height: 100%;
  background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
  animation: loading 1.5s infinite;
}

@keyframes loading {
  0% { left: -100%; }
  100% { left: 100%; }
}

/* Focus Indicators */
button:focus, input:focus, select:focus {
  outline: 4px solid var(--primary-blue) !important;
  outline-offset: 2px !important;
  box-shadow: 0 0 0 4px rgba(79, 70, 229, 0.3) !important;
}

/* Touch Targets */
button, input, select {
  min-height: 44px;
  min-width: 44px;
}

/* Custom Scrollbar */
::-webkit-scrollbar {
  width: 12px;
}

::-webkit-scrollbar-track {
  background: 
#f1f5f9;
  border-radius: 6px;
}

::-webkit-scrollbar-thumb {
  background: 
#cbd5e1;
  border-radius: 6px;
}

::-webkit-scrollbar-thumb:hover {
  background: 
#94a3b8;
}
</style>
</head>
<body class="bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50 min-h-screen text-size-normal">
<!-- Accessibility Panel -->
<div id="accessibility-panel" class="hidden fixed top-0 left-0 right-0 bg-gray-900 text-white p-4 z-50 shadow-2xl">
<div class="max-w-6xl mx-auto">
  <div class="flex flex-wrap items-center justify-between gap-4">
      <div class="flex items-center gap-2">
          <i class="fas fa-universal-access text-2xl"></i>
          <h2 class="text-xl font-bold">Painel de Acessibilidade</h2>
      </div>

      <div class="flex flex-wrap gap-4">
          <!-- Font Size Controls -->
          <div class="flex items-center gap-2">
              <span class="text-sm">Tamanho:</span>
              <button onclick="setFontSize('small')" class="px-3 py-1 bg-gray-700 rounded hover:bg-gray-600">A</button>
              <button onclick="setFontSize('normal')" class="px-3 py-1 bg-gray-700 rounded hover:bg-gray-600">A</button>
              <button onclick="setFontSize('large')" class="px-3 py-1 bg-gray-700 rounded hover:bg-gray-600 text-lg">A</button>
              <button onclick="setFontSize('xlarge')" class="px-3 py-1 bg-gray-700 rounded hover:bg-gray-600 text-xl">A</button>
          </div>

          <!-- Theme Controls -->
          <button onclick="toggleHighContrast()" class="px-3 py-1 bg-gray-700 rounded hover:bg-gray-600">
              <i class="fas fa-adjust"></i> Contraste
          </button>
          <button onclick="toggleNightMode()" class="px-3 py-1 bg-gray-700 rounded hover:bg-gray-600">
              <i class="fas fa-moon"></i> Noite
          </button>
          <button onclick="toggleReadingMode()" class="px-3 py-1 bg-gray-700 rounded hover:bg-gray-600">
              <i class="fas fa-book-open"></i> Leitura
          </button>

          <!-- Speech Controls -->
          <div class="flex items-center gap-2">
              <span class="text-sm">Fala:</span>
              <button onclick="setSpeechRate(0.5)" class="px-2 py-1 bg-gray-700 rounded hover:bg-gray-600">0.5x</button>
              <button onclick="setSpeechRate(1)" class="px-2 py-1 bg-gray-700 rounded hover:bg-gray-600">1x</button>
              <button onclick="setSpeechRate(1.5)" class="px-2 py-1 bg-gray-700 rounded hover:bg-gray-600">1.5x</button>
          </div>

          <button onclick="closeAccessibilityPanel()" class="px-4 py-2 bg-red-600 rounded hover:bg-red-500">
              <i class="fas fa-times"></i>
          </button>
      </div>
  </div>
</div>
</div>

<!-- Loading Screen -->
<div id="loading" class="fixed inset-0 bg-white z-40 flex items-center justify-center">
<div class="text-center">
  <div class="bg-gradient-to-br from-blue-400 to-purple-500 p-6 rounded-full mb-4 mx-auto w-20 h-20 flex items-center justify-center loading">
      <i data-lucide="message-circle" class="text-white w-10 h-10"></i>
  </div>
  <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent mb-4">Facilita+</h1>
  <p class="text-xl text-gray-600 mb-4">Carregando seu assistente inteligente...</p>
  <div class="flex justify-center gap-1 mb-4">
      <div class="w-3 h-3 bg-blue-400 rounded-full animate-bounce" style="animation-delay: 0ms;"></div>
      <div class="w-3 h-3 bg-purple-400 rounded-full animate-bounce" style="animation-delay: 150ms;"></div>
      <div class="w-3 h-3 bg-pink-400 rounded-full animate-bounce" style="animation-delay: 300ms;"></div>
  </div>
  <div class="text-sm text-gray-500">
      <p>Inicializando recursos de acessibilidade...</p>
  </div>
</div>
</div>

<!-- Emergency Alert -->
<div id="emergency-alert" class="hidden fixed inset-0 bg-red-600 bg-opacity-95 z-50 flex items-center justify-center p-4">
<div class="bg-white rounded-3xl p-8 max-w-md w-full text-center shadow-2xl">
  <div class="text-6xl mb-4">🚨</div>
  <h2 class="text-3xl font-bold text-red-600 mb-4">EMERGÊNCIA</h2>
  <p class="text-xl text-gray-800 mb-6">Números importantes:</p>
  <div class="space-y-3 mb-6">
      <a href="tel:192" class="block bg-red-500 text-white text-2xl font-bold py-4 rounded-2xl hover:bg-red-600 transition-colors">
          📞 SAMU - 192
      </a>
      <a href="tel:193" class="block bg-red-500 text-white text-2xl font-bold py-4 rounded-2xl hover:bg-red-600 transition-colors">
          🚑 BOMBEIROS - 193
      </a>
      <a href="tel:190" class="block bg-red-500 text-white text-2xl font-bold py-4 rounded-2xl hover:bg-red-600 transition-colors">
          🚔 POLÍCIA - 190
      </a>
  </div>
  <button onclick="closeEmergencyAlert()" class="bg-gray-500 text-white px-6 py-3 rounded-2xl hover:bg-gray-600">
      Fechar
  </button>
</div>
</div>

<!-- Voice Indicator -->
<div id="voice-indicator" class="hidden fixed top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 bg-red-500 text-white p-8 rounded-full z-40 voice-pulse">
<div class="text-center">
  <i class="fas fa-microphone text-4xl mb-2"></i>
  <p class="text-xl font-bold">Ouvindo...</p>
  <p class="text-sm">Fale agora</p>
</div>
</div>

<!-- Main App -->
<div id="app" class="hidden min-h-screen">
<!-- Floating Buttons -->
<button 
  onclick="toggleAccessibilityPanel()"
  class="fixed bottom-4 right-4 bg-blue-600 text-white p-4 rounded-full shadow-2xl hover:bg-blue-700 z-30"
  title="Painel de Acessibilidade (Ctrl+M)"
>
  <i class="fas fa-universal-access text-2xl"></i>
</button>

<button 
  onclick="showEmergencyAlert()"
  class="fixed bottom-20 right-4 bg-red-600 text-white p-4 rounded-full shadow-2xl emergency-button z-30"
  title="Emergência"
>
  <i class="fas fa-exclamation-triangle text-2xl"></i>
</button>

<!-- Welcome Screen -->
<div id="welcome-view" class="min-h-screen">
  <div class="container mx-auto px-6 py-8">
      <div class="max-w-md mx-auto">
          <!-- Logo -->
          <div class="text-center mb-12">
              <div class="bg-white p-8 rounded-3xl shadow-2xl mb-8 border-4 border-blue-100">
                  <div class="flex items-center justify-center gap-3 mb-6">
                      <div class="bg-gradient-to-br from-blue-400 to-purple-500 rounded-full p-4 shadow-lg loading">
                          <i data-lucide="message-circle" class="text-white w-10 h-10"></i>
                      </div>
                      <div>
                          <h1 class="text-4xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
                              Facilita+
                          </h1>
                          <p class="text-gray-600 text-lg font-medium">Powered by ORPHEO Platforms</p>
                      </div>
                  </div>

                  <div class="flex items-center justify-center gap-2 text-gray-600 mb-3">
                      <i class="fas fa-star text-yellow-500"></i>
                      <i class="fas fa-star text-yellow-500"></i>
                      <i class="fas fa-star text-yellow-500"></i>
                      <i class="fas fa-star text-yellow-500"></i>
                      <i class="fas fa-star text-yellow-500"></i>
                      <span class="ml-2 font-semibold">5.0 ⭐</span>
                  </div>
                  <p class="text-lg text-gray-600 font-medium">
                      Assistente Digital para 60+
                  </p>
              </div>

              <div class="bg-gradient-to-r from-green-50 to-blue-50 p-6 rounded-2xl shadow-lg mb-8">
                  <h2 class="text-3xl font-bold text-gray-800 mb-3">
                      👋 Olá, <span id="welcome-name" class="text-blue-600">Visitante</span>!
                  </h2>
                  <p class="text-xl text-gray-700">
                      Estou aqui para tornar sua vida mais fácil! 💙
                  </p>
              </div>
          </div>

          <!-- Status -->
          <div class="bg-white p-6 rounded-2xl shadow-lg mb-8">
              <div class="flex items-center justify-between mb-4">
                  <span class="text-xl font-bold text-gray-800">Sistema</span>
                  <span class="flex items-center gap-2 text-green-600 font-bold">
                      <div class="w-4 h-4 bg-green-400 rounded-full animate-pulse"></div>
                      Online
                  </span>
              </div>
              <div class="grid grid-cols-3 gap-4 text-center">
                  <div class="bg-blue-50 p-3 rounded-xl">
                      <i class="fas fa-thermometer-half text-blue-500 text-2xl mb-1"></i>
                      <p class="text-lg font-bold text-blue-700" id="current-temp">24°C</p>
                  </div>
                  <div class="bg-purple-50 p-3 rounded-xl">
                      <i class="fas fa-clock text-purple-500 text-2xl mb-1"></i>
                      <p class="text-lg font-bold text-purple-700" id="current-time">--:--</p>
                  </div>
                  <div class="bg-green-50 p-3 rounded-xl">
                      <i class="fas fa-calendar-day text-green-500 text-2xl mb-1"></i>
                      <p class="text-lg font-bold text-green-700" id="current-date">--/--</p>
                  </div>
              </div>
          </div>

          <!-- Main Button -->
          <button
              onclick="showView('main')"
              class="w-full bg-gradient-to-r from-green-400 to-blue-500 hover:from-green-500 hover:to-blue-600 text-white text-3xl font-bold py-10 px-8 rounded-3xl shadow-2xl transform transition-all duration-300 hover:scale-105"
          >
              <div class="flex items-center justify-center gap-4">
                  <i data-lucide="message-circle" class="w-10 h-10"></i>
                  Começar Conversa
              </div>
          </button>

          <!-- Voice Command -->
          <div class="mt-6 text-center">
              <p class="text-gray-600 mb-3">Ou use comando de voz:</p>
              <button
                  onclick="startVoiceCommand()"
                  class="bg-gradient-to-r from-blue-400 to-purple-500 hover:from-blue-500 hover:to-purple-600 text-white text-xl font-bold py-4 px-8 rounded-full shadow-lg transform transition-all duration-200 hover:scale-105"
              >
                  <i class="fas fa-microphone mr-2"></i>
                  Falar com o Facilita+
              </button>
          </div>
      </div>
  </div>

  <!-- Footer -->
  <div class="bg-gradient-to-r from-gray-100 to-gray-200 border-t-4 border-gray-300 py-6 px-6">
      <div class="max-w-md mx-auto text-center space-y-3">
          <div class="font-bold text-2xl bg-gradient-to-r from-purple-600 to-blue-600 bg-clip-text text-transparent">
              ORPHEO Platforms
          </div>
          <div class="text-sm text-gray-600">
              <p>v1.0.0 • Kai Assistente Digital</p>
              <p>🛡️ Seguro • ♿ Acessível • 🧠 Inteligente</p>
          </div>
      </div>
  </div>
</div>

<!-- Main Menu -->
<div id="main-view" class="hidden min-h-screen flex flex-col">
  <!-- Header -->
  <div class="bg-gradient-to-r from-white to-blue-50 shadow-2xl border-b-4 border-blue-100">
      <div class="max-w-md mx-auto p-4">
          <div class="flex items-center justify-between">
              <button
                  onclick="showView('welcome')"
                  class="bg-blue-100 hover:bg-blue-200 text-blue-600 p-3 rounded-full shadow-md transition-all duration-200 hover:scale-105"
              >
                  <i class="fas fa-home text-xl"></i>
              </button>

              <div class="flex items-center justify-center gap-2">
                  <div class="bg-gradient-to-br from-blue-400 to-purple-500 rounded-full p-3 shadow-lg">
                      <i data-lucide="message-circle" class="text-white w-8 h-8"></i>
                  </div>
                  <div>
                      <h1 class="text-2xl font-bold bg-gradient-to-r from-blue-600 to-purple-600 bg-clip-text text-transparent">
                          Facilita+
                      </h1>
                  </div>
              </div>

              <button
                  onclick="toggleProfile()"
                  class="bg-gray-100 hover:bg-gray-200 text-gray-600 p-3 rounded-full shadow-md transition-all duration-200 hover:scale-105"
              >
                  <i data-lucide="user" class="w-6 h-6"></i>
              </button>
          </div>

          <div class="text-center mt-4">
              <h2 class="text-2xl font-bold text-gray-800">Como posso te ajudar?</h2>
          </div>
      </div>
  </div>

  <div class="flex-1 p-6">
      <div class="max-w-md mx-auto space-y-6">
          <!-- Greeting -->
          <div class="bg-gradient-to-r from-white to-blue-50 p-6 rounded-3xl shadow-lg border-2 border-blue-100">
              <div class="text-center">
                  <h3 class="text-2xl font-bold text-gray-800 mb-2">
                      <span id="greeting">Olá</span>, <span id="main-username" class="text-blue-600">querido(a)</span>! 🌟
                  </h3>
                  <p class="text-lg text-gray-700">
                      Como posso te ajudar hoje? 😊
                  </p>
              </div>
          </div>

          <!-- Action Buttons -->
          <div class="grid gap-4">
              <button
                  onclick="quickAction('chat')"
                  class="bg-gradient-to-r from-blue-400 to-blue-600 hover:from-blue-500 hover:to-blue-700 text-white text-2xl font-bold py-8 px-6 rounded-3xl shadow-xl transform transition-all duration-200 hover:scale-105 flex items-center justify-center gap-4"
              >
                  <i data-lucide="message-circle" class="w-8 h-8"></i>
                  Conversar Comigo
              </button>

              <div class="grid grid-cols-2 gap-4">
                  <button flex flex-col items-center gap-3"
                            >
                                <i data-lucide="alert-circle" class="w-8 h-8"></i>
                                Emergência
                            </button>
                        </div>

                        <button
                            onclick="quickAction('voice')"
                            class="bg-gradient-to-r from-green-400 to-green-600 hover:from-green-500 hover:to-green-700 text-white text-2xl font-bold py-8 px-6 rounded-3xl shadow-xl transform transition-all duration-200 hover:scale-105 flex items-center justify-center gap-4"
                        >
                            <i class="fas fa-microphone text-3xl"></i>
                            Comando de Voz
                        </button>
                    </div>

                    <!-- Tips -->
                    <div class="bg-gradient-to-r from-yellow-50 to-orange-50 p-6 rounded-3xl shadow-lg border-2 border-yellow-200">
                        <h3 class="text-xl font-bold text-gray-800 mb-3 flex items-center gap-2">
                            <i class="fas fa-lightbulb text-yellow-500 text-2xl"></i>
                            Dica do Dia
                        </h3>
                        <p class="text-lg text-gray-700" id="daily-tip">
                            Carregando dica...
                        </p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat View -->
        <div id="chat-view" class="hidden min-h-screen flex flex-col">
            <!-- Chat Header -->
            <div class="bg-gradient-to-r from-white to-blue-50 shadow-2xl border-b-4 border-blue-100">
                <div class="max-w-3xl mx-auto p-4">
                    <div class="flex items-center justify-between">
                        <button
                            onclick="showView('main')"
                            class="bg-blue-100 hover:bg-blue-200 text-blue-600 p-3 rounded-full shadow-md transition-all duration-200 hover:scale-105"
                        >
                            <i class="fas fa-arrow-left text-xl"></i>
                        </button>
                        
                        <div class="flex items-center gap-2">
                            <div class="bg-gradient-to-br from-blue-400 to-purple-500 rounded-full p-3 shadow-lg">
                                <i data-png="https://i.imgur.com/tTkjOO6.png" class="text-white w-6 h-6"></i>
                            </div>
                            <div>
                                <h1 class="text-xl font-bold text-gray-800">KAI</h1>
                                <div class="flex items-center gap-1 text-sm text-green-600">
                                    <div class="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
                                    Online
                                </div>
                            </div>
                        </div>
                        
                        <button
                            onclick="clearChat()"
                            class="bg-red-100 hover:bg-red-200 text-red-600 p-3 rounded-full shadow-md transition-all duration-200 hover:scale-105"
                            title="Limpar conversa"
                        >
                            <i data-lucide="trash-2" class="w-6 h-6"></i>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Chat Messages -->
            <div id="chat-messages" class="flex-1 overflow-y-auto p-6 bg-gradient-to-br from-blue-50 via-purple-50 to-pink-50">
                <div class="max-w-3xl mx-auto space-y-4">
                    <!-- Welcome Message -->
                    <div class="chat-message flex gap-3">
                        <div class="bg-gradient-to-br from-blue-400 to-purple-500 rounded-full p-3 shadow-lg h-12 w-12 flex-shrink-0">
                            <i data-png="https://i.imgur.com/tTkjOO6.png" class="text-white w-6 h-6"></i>
                        </div>
                        <div class="bg-white p-6 rounded-3xl rounded-tl-none shadow-lg max-w-md">
                            <p class="text-lg text-gray-800">
                                Olá! 👋 Sou o Kai, sua assistente digital! Estou aqui para conversar, ajudar e tornar seu dia melhor. Como posso te ajudar hoje? 😊
                            </p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Chat Input -->
            <div class="bg-white shadow-2xl border-t-4 border-blue-100 p-4">
                <div class="max-w-3xl mx-auto">
                    <!-- Quick Actions -->
                    <div class="flex gap-2 mb-4 overflow-x-auto pb-2">
                        <button
                            onclick="sendQuickMessage('Olá!')"
                            class="bg-blue-100 hover:bg-blue-200 text-blue-800 px-4 py-2 rounded-full font-semibold whitespace-nowrap shadow-md"
                        >
                            👋 Olá
                        </button>
                        <button
                            onclick="sendQuickMessage('Preciso de ajuda')"
                            class="bg-purple-100 hover:bg-purple-200 text-purple-800 px-4 py-2 rounded-full font-semibold whitespace-nowrap shadow-md"
                        >
                            🤝 Ajuda
                        </button>
                        <button
                            onclick="sendQuickMessage('Criar um lembrete')"
                            class="bg-green-100 hover:bg-green-200 text-green-800 px-4 py-2 rounded-full font-semibold whitespace-nowrap shadow-md"
                        >
                            ⏰ Lembrete
                        </button>
                        <button
                            onclick="sendQuickMessage('Como está o tempo?')"
                            class="bg-orange-100 hover:bg-orange-200 text-orange-800 px-4 py-2 rounded-full font-semibold whitespace-nowrap shadow-md"
                        >
                            ☀️ Tempo
                        </button>
                    </div>

                    <!-- Input Area -->
                    <div class="flex gap-2">
                        <input
                            type="text"
                            id="chat-input"
                            placeholder="Digite sua mensagem aqui..."
                            class="flex-1 px-6 py-4 text-xl border-2 border-gray-300 rounded-full focus:outline-none focus:border-blue-500 shadow-lg"
                            onkeypress="handleChatKeyPress(event)"
                        />
                        <button
                            onclick="startVoiceInput()"
                            class="bg-gradient-to-r from-green-400 to-green-600 hover:from-green-500 hover:to-green-700 text-white p-4 rounded-full shadow-xl transform transition-all duration-200 hover:scale-105"
                            title="Usar voz"
                        >
                            <i class="fas fa-microphone text-2xl"></i>
                        </button>
                        <button
                            onclick="sendMessage()"
                            class="bg-gradient-to-r from-blue-400 to-purple-500 hover:from-blue-500 hover:to-purple-600 text-white px-8 py-4 rounded-full font-bold text-xl shadow-xl transform transition-all duration-200 hover:scale-105"
                        >
                            <i data-lucide="send" class="w-6 h-6"></i>
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <!-- Profile View -->
        <div id="profile-view" class="hidden min-h-screen flex flex-col">
            <div class="bg-gradient-to-r from-white to-blue-50 shadow-2xl border-b-4 border-blue-100">
                <div class="max-w-md mx-auto p-4">
                    <div class="flex items-center justify-between mb-4">
                        <button
                            onclick="showView('main')"
                            class="bg-blue-100 hover:bg-blue-200 text-blue-600 p-3 rounded-full shadow-md transition-all duration-200 hover:scale-105"
                        >
                            <i class="fas fa-arrow-left text-xl"></i>
                        </button>
                        <h1 class="text-2xl font-bold text-gray-800">Meu Perfil</h1>
                        <div class="w-12"></div>
                    </div>
                </div>
            </div>

            <div class="flex-1 p-6">
                <div class="max-w-md mx-auto space-y-6">
                    <!-- Profile Card -->
                    <div class="bg-gradient-to-r from-white to-blue-50 p-8 rounded-3xl shadow-2xl border-2 border-blue-100">
                        <div class="text-center mb-6">
                            <div class="bg-gradient-to-br from-blue-400 to-purple-500 rounded-full p-6 w-24 h-24 mx-auto mb-4 shadow-lg">
                                <i data-lucide="user" class="text-white w-12 h-12"></i>
                            </div>
                            <h2 class="text-3xl font-bold text-gray-800 mb-2" id="profile-name">Visitante</h2>
                            <p class="text-lg text-gray-600">Usuário desde hoje</p>
                        </div>

                        <div class="space-y-4">
                            <div>
                                <label class="block text-lg font-bold text-gray-700 mb-2">Seu Nome:</label>
                                <input
                                    type="text"
                                    id="user-name"
                                    placeholder="Digite seu nome"
                                    class="w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-2xl focus:outline-none focus:border-blue-500"
                                />
                            </div>

                            <button
                                onclick="saveProfile()"
                                class="w-full bg-gradient-to-r from-green-400 to-blue-500 hover:from-green-500 hover:to-blue-600 text-white text-xl font-bold py-4 rounded-2xl shadow-lg transform transition-all duration-200 hover:scale-105"
                            >
                                💾 Salvar Perfil
                            </button>
                        </div>
                    </div>

                    <!-- Preferences -->
                    <div class="bg-white p-6 rounded-3xl shadow-lg">
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">⚙️ Preferências</h3>
                        
                        <div class="space-y-4">
                            <div class="flex items-center justify-between p-4 bg-blue-50 rounded-2xl">
                                <span class="text-lg font-semibold text-gray-800">🔔 Notificações</span>
                                <label class="relative inline-block w-16 h-8">
                                    <input type="checkbox" id="notifications" class="sr-only peer" checked>
                                    <div class="w-16 h-8 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-8 peer-checked:after:border-white after:content-[''] after:absolute after:top-1 after:left-1 after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-blue-600"></div>
                                </label>
                            </div>

                            <div class="flex items-center justify-between p-4 bg-purple-50 rounded-2xl">
                                <span class="text-lg font-semibold text-gray-800">🔊 Som</span>
                                <label class="relative inline-block w-16 h-8">
                                    <input type="checkbox" id="sound" class="sr-only peer" checked>
                                    <div class="w-16 h-8 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-purple-300 rounded-full peer peer-checked:after:translate-x-8 peer-checked:after:border-white after:content-[''] after:absolute after:top-1 after:left-1 after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-purple-600"></div>
                                </label>
                            </div>

                            <div class="flex items-center justify-between p-4 bg-green-50 rounded-2xl">
                                <span class="text-lg font-semibold text-gray-800">🗣️ Respostas por Voz</span>
                                <label class="relative inline-block w-16 h-8">
                                    <input type="checkbox" id="voice-response" class="sr-only peer" checked>
                                    <div class="w-16 h-8 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-green-300 rounded-full peer peer-checked:after:translate-x-8 peer-checked:after:border-white after:content-[''] after:absolute after:top-1 after:left-1 after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-green-600"></div>
                                </label>
                            </div>
                        </div>
                    </div>

                    <!-- Statistics -->
                    <div class="bg-gradient-to-r from-blue-50 to-purple-50 p-6 rounded-3xl shadow-lg">
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">📊 Estatísticas</h3>
                        
                        <div class="grid grid-cols-2 gap-4">
                            <div class="bg-white p-4 rounded-2xl text-center">
                                <p class="text-3xl font-bold text-blue-600" id="stat-messages">0</p>
                                <p class="text-sm text-gray-600">Mensagens</p>
                            </div>
                            <div class="bg-white p-4 rounded-2xl text-center">
                                <p class="text-3xl font-bold text-purple-600" id="stat-reminders">0</p>
                                <p class="text-sm text-gray-600">Lembretes</p>
                            </div>
                            <div class="bg-white p-4 rounded-2xl text-center">
                                <p class="text-3xl font-bold text-green-600" id="stat-days">1</p>
                                <p class="text-sm text-gray-600">Dias de uso</p>
                            </div>
                            <div class="bg-white p-4 rounded-2xl text-center">
                                <p class="text-3xl font-bold text-orange-600" id="stat-voice">0</p>
                                <p class="text-sm text-gray-600">Comandos voz</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global State
        let appState = {
            currentView: 'loading',
            userName: localStorage.getItem('userName') || 'Visitante',
            chatHistory: [],
            speechRate: parseFloat(localStorage.getItem('speechRate')) || 1,
            fontSize: localStorage.getItem('fontSize') || 'normal',
            theme: localStorage.getItem('theme') || 'default',
            preferences: {
                notifications: true,
                sound: true,
                voiceResponse: true
            },
            statistics: {
                messages: parseInt(localStorage.getItem('stat-messages')) || 0,
                reminders: parseInt(localStorage.getItem('stat-reminders')) || 0,
                days: parseInt(localStorage.getItem('stat-days')) || 1,
                voiceCommands: parseInt(localStorage.getItem('stat-voice')) || 0
            }
        };

        // Speech Synthesis
        const synth = window.speechSynthesis;
        let currentUtterance = null;

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('app').classList.remove('hidden');
                showView('welcome');
                initializeApp();
            }, 2000);

            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.key === 'm') {
                    e.preventDefault();
                    toggleAccessibilityPanel();
                }
            });

            // Initialize Lucide icons
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        });

        function initializeApp() {
            // Load saved data
            loadUserData();
            updateDateTime();
            setInterval(updateDateTime, 1000);
            loadDailyTip();
            updateStatistics();
            applyAccessibilitySettings();
            getWeather();
        }

        function loadUserData() {
            if (appState.userName !== 'Visitante') {
                document.getElementById('welcome-name').textContent = appState.userName;
                document.getElementById('main-username').textContent = appState.userName;
                document.getElementById('profile-name').textContent = appState.userName;
                document.getElementById('user-name').value = appState.userName;
            }
        }

        function updateDateTime() {
            const now = new Date();
            const hours = now.getHours();
            
            // Update time
            document.getElementById('current-time').textContent = now.toLocaleTimeString('pt-BR', { 
                hour: '2-digit', 
                minute: '2-digit' 
            });
            
            // Update date
            document.getElementById('current-date').textContent = now.toLocaleDateString('pt-BR', { 
                day: '2-digit', 
                month: '2-digit' 
            });
            
            // Update greeting
            let greeting = 'Olá';
            if (hours >= 5 && hours < 12) greeting = 'Bom dia';
            else if (hours >= 12 && hours < 18) greeting = 'Boa tarde';
            else greeting = 'Boa noite';
            
            const greetingEl = document.getElementById('greeting');
            if (greetingEl) greetingEl.textContent = greeting;
        }

        function getWeather() {
            // Simulated weather (in production, use a real API)
            const temps = [20, 22, 24, 26, 28, 30];
            const temp = temps[Math.floor(Math.random() * temps.length)];
            document.getElementById('current-temp').textContent = `${temp}°C`;
        }

        function loadDailyTip() {
            const tips = [
                "🌟 Beba bastante água durante o dia para se manter hidratado!",
                "🚶 Faça uma caminhada de 15 minutos. Sua saúde agradece!",
                "📱 Explore o menu de acessibilidade do seu celular. Há muitas ferramentas úteis!",
                "👥 Ligue para um amigo ou familiar hoje. Conexões sociais são importantes!",
                "😊 Pratique gratidão: pense em 3 coisas boas do seu dia.",
                "🧘 Respire fundo 5 vezes. Isso ajuda a relaxar e reduzir o estresse.",
                "📚 Aprenda algo novo hoje, por menor que seja!",
                "🎵 Ouça uma música que você adora. Música faz bem para a alma!",
                "☀️ Pegue um pouco de sol. A vitamina D é importante!",
                "💪 Alongue-se por alguns minutos. Seu corpo agradece!"
            ];
            
            const tip = tips[Math.floor(Math.random() * tips.length)];
            const tipEl = document.getElementById('daily-tip');
            if (tipEl) tipEl.textContent = tip;
        }

        function updateStatistics() {
            document.getElementById('stat-messages').textContent = appState.statistics.messages;
            document.getElementById('stat-reminders').textContent = appState.statistics.reminders;
            document.getElementById('stat-days').textContent = appState.statistics.days;
            document.getElementById('stat-voice').textContent = appState.statistics.voiceCommands;
        }

        function incrementStat(stat) {
            appState.statistics[stat]++;
            localStorage.setItem(`stat-${stat}`, appState.statistics[stat]);
            updateStatistics();
        }

        // Navigation
        function showView(viewName) {
            const views = ['welcome', 'main', 'chat', 'profile'];
            views.forEach(view => {
                document.getElementById(`${view}-view`).classList.add('hidden');
            });
            document.getElementById(`${viewName}-view`).classList.remove('hidden');
            appState.currentView = viewName;

            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function toggleProfile() {
            showView('profile');
        }

        function saveProfile() {
            const nameInput = document.getElementById('user-name');
            const name = nameInput.value.trim();
            
            if (name) {
                appState.userName = name;
                localStorage.setItem('userName', name);
                loadUserData();
                speak('Perfil salvo com sucesso! Olá ' + name + '!');
                showView('main');
            } else {
                alert('Por favor, digite seu nome.');
            }
        }

        // Quick Actions
        function quickAction(action) {
            switch(action) {
                case 'chat':
                    showView('chat');
                    break;
                case 'reminder':
                    showView('chat');
                    setTimeout(() => {
                        sendQuickMessage('Quero criar um lembrete');
                    }, 500);
                    break;
                case 'phone-help':
                    showView('chat');
                    setTimeout(() => {
                        sendQuickMessage('Preciso de ajuda com meu celular');
                    }, 500);
                    break;
                case 'sad':
                    showView('chat');
                    setTimeout(() => {
                        sendQuickMessage('Estou me sentindo sozinho');
                    }, 500);
                    break;
                case 'emergency':
                    showEmergencyAlert();
                    break;
                case 'voice':
                    startVoiceCommand();
                    break;
            }
        }

        // Chat Functions
        function sendMessage() {
            const input = document.getElementById('chat-input');
            const message = input.value.trim();
            
            if (message) {
                addMessage('user', message);
                input.value = '';
                incrementStat('messages');
                
                // Simulate AI response
                setTimeout(() => {
                    const response = generateResponse(message);
                    addMessage('bot', response);
                    if (appState.preferences.voiceResponse) {
                        speak(response);
                    }
                }, 1000);
            }
        }

        function sendQuickMessage(message) {
            addMessage('user', message);
            incrementStat('messages');
            
            setTimeout(() => {
                const response = generateResponse(message);
                addMessage('bot', response);
                if (appState.preferences.voiceResponse) {
                    speak(response);
                }
            }, 1000);
        }

        function handleChatKeyPress(event) {
            if (event.key === 'Enter') {
                sendMessage();
            }
        }

        function addMessage(sender, text) {
            const messagesContainer = document.getElementById('chat-messages');
            const messageDiv = document.createElement('div');
            messageDiv.className = 'chat-message flex gap-3' + (sender === 'user' ? ' flex-row-reverse' : '');
            
            if (sender === 'bot') {
                messageDiv.innerHTML = `
                    <div class="bg-gradient-to-br from-blue-400 to-purple-500 rounded-full p-3 shadow-lg h-12 w-12 flex-shrink-0">
                        <i data-lucide="bot" class="text-white w-6 h-6"></i>
                    </div>
                    <div class="bg-white p-6 rounded-3xl ${sender === 'user' ? 'rounded-tr-none' : 'rounded-tl-none'} shadow-lg max-w-md">
                        <p class="text-lg text-gray-800">${text}</p>
                    </div>
                `;
            } else {
                messageDiv.innerHTML = `
                    <div class="bg-gradient-to-br from-green-400 to-blue-500 rounded-full p-3 shadow-lg h-12 w-12 flex-shrink-0">
                        <i data-lucide="user" class="text-white w-6 h-6"></i>
                    </div>
                    <div class="bg-gradient-to-r from-blue-400 to-purple-500 text-white p-6 rounded-3xl ${sender === 'user' ? 'rounded-tr-none' : 'rounded-tl-none'} shadow-lg max-w-md">
                        <p class="text-lg">${text}</p>
                    </div>
                `;
            }
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            if (typeof lucide !== 'undefined') {
                lucide.createIcons();
            }
        }

        function generateResponse(message) {
            const msg = message.toLowerCase();
            
            // Greetings
            if (msg.includes('olá') || msg.includes('oi') || msg.includes('bom dia') || msg.includes('boa tarde') || msg.includes('boa noite')) {
                return `Olá, ${appState.userName}! 😊 Como posso te ajudar hoje?`;
            }
            
            // Reminders
            if (msg.includes('lembrete') || msg.includes('lembrar')) {
                incrementStat('reminders');
                return '⏰ Ótimo! Para criar um lembrete, me diga:\n\n1️⃣ O que você quer lembrar?\n2️⃣ Quando? (dia e hora)\n\nPor exemplo: "Lembrar de tomar remédio amanhã às 8h"';
            }
            
            // Phone help
            if (msg.includes('celular') || msg.includes('telefone') || msg.includes('whatsapp')) {
                return '📱 Claro! Posso te ajudar com:\n\n• WhatsApp e mensagens\n• Fazer ligações\n• Tirar fotos\n• Configurações\n• Apps úteis\n\nQual sua dúvida específica?';
            }
            
            // Emotional support
            if (msg.includes('sozinho') || msg.includes('triste') || msg.includes('solidão')) {
                return '💙 Entendo como você se sente. Estar sozinho pode ser difícil, mas saiba que você não está realmente sozinho. Que tal:\n\n• Ligar para um amigo ou familiar?\n• Participar de um grupo social?\n• Fazer uma atividade que você gosta?\n\nEstou aqui para conversar sempre que precisar! 🤗';
            }
            
            // Weather
            if (msg.includes('tempo') || msg.includes('clima') || msg.includes('chuva') || msg.includes('sol')) {
                return '☀️ Hoje está um dia agradável! A temperatura está em torno de 24°C. Bom dia para uma caminhada ou para sair um pouco!';
            }
            
            // Health
            if (msg.includes('saúde') || msg.includes('médico') || msg.includes('remédio') || msg.includes('dor')) {
                return '🏥 Para questões de saúde, é sempre importante consultar um profissional. Posso:\n\n• Criar lembretes para remédios\n• Te ajudar a encontrar contatos médicos\n• Chamar ajuda em emergências\n\nComo posso ajudar?';
            }
            
            // Thanks
            if (msg.includes('obrigad') || msg.includes('valeu')) {
                return '😊 Por nada! Estou sempre aqui para te ajudar. É um prazer poder ajudar você!';
            }
            
            // Help
            if (msg.includes('ajuda') || msg.includes('ajudar') || msg.includes('pode fazer')) {
                return '🤗 Posso te ajudar com:\n\n✅ Conversar e fazer companhia\n✅ Criar lembretes\n✅ Ajuda com tecnologia\n✅ Informações úteis\n✅ Apoio emocional\n✅ Emergências\n\nO que você precisa?';
            }
            
            // Default
            return 'Entendo! 😊 Estou aqui para te ajudar. Pode me contar mais sobre isso? Ou me dizer como posso te auxiliar melhor?';
        }

        function clearChat() {
            if (confirm('Tem certeza que deseja limpar toda a conversa?')) {
                const messagesContainer = document.getElementById('chat-messages');
                messagesContainer.innerHTML = `
                    <div class="chat-message flex gap-3">
                        <div class="bg-gradient-to-br from-blue-400 to-purple-500 rounded-full p-3 shadow-lg h-12 w-12 flex-shrink-0">
                            <i data-lucide="bot" class="text-white w-6 h-6"></i>
                        </div>
                        <div class="bg-white p-6 rounded-3xl rounded-tl-none shadow-lg max-w-md">
                            <p class="text-lg text-gray-800">
                                Olá! 👋 Sou o Facilita+, sua assistente digital! Estou aqui para conversar, ajudar e tornar seu dia melhor. Como posso te ajudar hoje? 😊
                            </p>
                        </div>
                    </div>
                `;
                
                if (typeof lucide !== 'undefined') {
                    lucide.createIcons();
                }
              speak('Conversa limpa! Como posso te ajudar agora?');
            }
        }

        // Voice Functions
        function speak(text) {
            if ('speechSynthesis' in window) {
                // Cancel any ongoing speech
                synth.cancel();
                
                currentUtterance = new SpeechSynthesisUtterance(text);
                currentUtterance.lang = 'pt-BR';
                currentUtterance.rate = appState.speechRate;
                currentUtterance.pitch = 1;
                currentUtterance.volume = 1;
                
                synth.speak(currentUtterance);
            }
        }

        function stopSpeaking() {
            if ('speechSynthesis' in window) {
                synth.cancel();
            }
        }

        function startVoiceInput() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Desculpe, seu navegador não suporta reconhecimento de voz. Por favor, use o Chrome ou Edge.');
                return;
            }

            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            
            recognition.lang = 'pt-BR';
            recognition.continuous = false;
            recognition.interimResults = false;

            document.getElementById('voice-indicator').classList.remove('hidden');
            incrementStat('voiceCommands');

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript;
                document.getElementById('chat-input').value = transcript;
                document.getElementById('voice-indicator').classList.add('hidden');
                sendMessage();
            };

            recognition.onerror = (event) => {
                document.getElementById('voice-indicator').classList.add('hidden');
                console.error('Erro no reconhecimento de voz:', event.error);
                
                if (event.error === 'no-speech') {
                    alert('Não consegui ouvir nada. Tente novamente!');
                } else if (event.error === 'not-allowed') {
                    alert('Por favor, permita o acesso ao microfone nas configurações do navegador.');
                } else {
                    alert('Erro no reconhecimento de voz. Tente novamente!');
                }
            };

            recognition.onend = () => {
                document.getElementById('voice-indicator').classList.add('hidden');
            };

            recognition.start();
        }

        function startVoiceCommand() {
            if (!('webkitSpeechRecognition' in window) && !('SpeechRecognition' in window)) {
                alert('Desculpe, seu navegador não suporta reconhecimento de voz. Por favor, use o Chrome ou Edge.');
                return;
            }

            const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
            const recognition = new SpeechRecognition();
            
            recognition.lang = 'pt-BR';
            recognition.continuous = false;
            recognition.interimResults = false;

            document.getElementById('voice-indicator').classList.remove('hidden');
            speak('Estou ouvindo. O que você precisa?');
            incrementStat('voiceCommands');

            recognition.onresult = (event) => {
                const transcript = event.results[0][0].transcript.toLowerCase();
                document.getElementById('voice-indicator').classList.add('hidden');
                
                handleVoiceCommand(transcript);
            };

            recognition.onerror = (event) => {
                document.getElementById('voice-indicator').classList.add('hidden');
                console.error('Erro no reconhecimento de voz:', event.error);
                
                if (event.error === 'no-speech') {
                    speak('Não consegui ouvir nada. Tente novamente!');
                } else if (event.error === 'not-allowed') {
                    alert('Por favor, permita o acesso ao microfone nas configurações do navegador.');
                } else {
                    speak('Erro no reconhecimento de voz. Tente novamente!');
                }
            };

            recognition.onend = () => {
                document.getElementById('voice-indicator').classList.add('hidden');
            };

            setTimeout(() => {
                recognition.start();
            }, 1500);
        }

        function handleVoiceCommand(command) {
            console.log('Comando de voz:', command);
            
            // Navigation commands
            if (command.includes('voltar') || command.includes('menu') || command.includes('início')) {
                showView('main');
                speak('Voltando ao menu principal');
                return;
            }
            
            if (command.includes('conversar') || command.includes('chat') || command.includes('falar')) {
                showView('chat');
                speak('Abrindo conversa. Como posso te ajudar?');
                return;
            }
            
            if (command.includes('perfil') || command.includes('configurações')) {
                showView('profile');
                speak('Abrindo seu perfil');
                return;
            }
            
            // Action commands
            if (command.includes('lembrete') || command.includes('lembrar')) {
                quickAction('reminder');
                return;
            }
            
            if (command.includes('celular') || command.includes('telefone') || command.includes('ajuda')) {
                quickAction('phone-help');
                return;
            }
            
            if (command.includes('emergência') || command.includes('socorro') || command.includes('ajuda urgente')) {
                showEmergencyAlert();
                return;
            }
            
            if (command.includes('sozinho') || command.includes('triste') || command.includes('conversar')) {
                quickAction('sad');
                return;
            }
            
            // Time and weather
            if (command.includes('que horas') || command.includes('hora')) {
                const now = new Date();
                const time = now.toLocaleTimeString('pt-BR', { hour: '2-digit', minute: '2-digit' });
                speak(`Agora são ${time}`);
                return;
            }
            
            if (command.includes('que dia') || command.includes('data')) {
                const now = new Date();
                const date = now.toLocaleDateString('pt-BR', { 
                    weekday: 'long', 
                    year: 'numeric', 
                    month: 'long', 
                    day: 'numeric' 
                });
                speak(`Hoje é ${date}`);
                return;
            }
            
            if (command.includes('tempo') || command.includes('clima')) {
                speak('O tempo hoje está agradável, com temperatura em torno de 24 graus');
                return;
            }
            
            // Accessibility commands
            if (command.includes('aumentar texto') || command.includes('letra maior')) {
                setFontSize('xlarge');
                speak('Texto aumentado');
                return;
            }
            
            if (command.includes('diminuir texto') || command.includes('letra menor')) {
                setFontSize('normal');
                speak('Texto normalizado');
                return;
            }
            
            if (command.includes('modo noturno') || command.includes('escuro')) {
                toggleNightMode();
                return;
            }
            
            if (command.includes('contraste')) {
                toggleHighContrast();
                return;
            }
            
            // Default: open chat with the command as message
            showView('chat');
            setTimeout(() => {
                sendQuickMessage(command);
            }, 500);
        }

        // Accessibility Functions
        function toggleAccessibilityPanel() {
            const panel = document.getElementById('accessibility-panel');
            panel.classList.toggle('hidden');
        }

        function closeAccessibilityPanel() {
            document.getElementById('accessibility-panel').classList.add('hidden');
        }

        function setFontSize(size) {
            document.body.className = document.body.className.replace(/text-size-\w+/, '');
            document.body.classList.add(`text-size-${size}`);
            appState.fontSize = size;
            localStorage.setItem('fontSize', size);
            
            const sizes = { small: 'pequeno', normal: 'normal', large: 'grande', xlarge: 'muito grande' };
            speak(`Tamanho de texto alterado para ${sizes[size]}`);
        }

        function toggleHighContrast() {
            document.body.classList.toggle('high-contrast');
            const isActive = document.body.classList.contains('high-contrast');
            appState.theme = isActive ? 'high-contrast' : 'default';
            localStorage.setItem('theme', appState.theme);
            
            speak(isActive ? 'Modo alto contraste ativado' : 'Modo alto contraste desativado');
        }

        function toggleNightMode() {
            document.body.classList.toggle('night-mode');
            const isActive = document.body.classList.contains('night-mode');
            
            if (isActive) {
                document.body.classList.remove('high-contrast', 'reading-mode');
                appState.theme = 'night-mode';
            } else {
                appState.theme = 'default';
            }
            
            localStorage.setItem('theme', appState.theme);
            speak(isActive ? 'Modo noturno ativado' : 'Modo noturno desativado');
        }

        function toggleReadingMode() {
            document.body.classList.toggle('reading-mode');
            const isActive = document.body.classList.contains('reading-mode');
            
            if (isActive) {
                document.body.classList.remove('high-contrast', 'night-mode');
                appState.theme = 'reading-mode';
            } else {
                appState.theme = 'default';
            }
            
            localStorage.setItem('theme', appState.theme);
            speak(isActive ? 'Modo leitura ativado' : 'Modo leitura desativado');
        }

        function setSpeechRate(rate) {
            appState.speechRate = rate;
            localStorage.setItem('speechRate', rate);
            
            const rates = { 0.5: 'devagar', 1: 'normal', 1.5: 'rápido' };
            speak(`Velocidade de fala alterada para ${rates[rate]}`);
        }

        function applyAccessibilitySettings() {
            // Apply saved font size
            if (appState.fontSize) {
                document.body.classList.add(`text-size-${appState.fontSize}`);
            }
            
            // Apply saved theme
            if (appState.theme && appState.theme !== 'default') {
                document.body.classList.add(appState.theme);
            }
        }

        // Emergency Functions
        function showEmergencyAlert() {
            document.getElementById('emergency-alert').classList.remove('hidden');
            speak('Números de emergência disponíveis na tela');
            
            // Add to body to prevent scroll
            document.body.style.overflow = 'hidden';
        }

        function closeEmergencyAlert() {
            document.getElementById('emergency-alert').classList.add('hidden');
            document.body.style.overflow = 'auto';
        }

        // PWA Installation
        let deferredPrompt;

        window.addEventListener('beforeinstallprompt', (e) => {
            e.preventDefault();
            deferredPrompt = e;
            
            // Show install button if needed
            console.log('PWA pode ser instalado');
        });

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('Service Worker registrado com sucesso:', registration.scope);
                    })
                    .catch(error => {
                        console.log('Falha ao registrar Service Worker:', error);
                    });
            });
        }

        // Online/Offline Detection
        window.addEventListener('online', () => {
            console.log('Conectado à internet');
            speak('Conexão restaurada');
        });

        window.addEventListener('offline', () => {
            console.log('Sem conexão com a internet');
            speak('Você está sem conexão com a internet');
        });

        // Notification Permission
        function requestNotificationPermission() {
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission().then(permission => {
                    if (permission === 'granted') {
                        console.log('Permissão de notificação concedida');
                    }
                });
            }
        }

        // Request notification permission after a delay
        setTimeout(requestNotificationPermission, 5000);

        // Battery Status
        if ('getBattery' in navigator) {
            navigator.getBattery().then(battery => {
                if (battery.level < 0.2 && !battery.charging) {
                    speak('Atenção! A bateria do seu dispositivo está baixa');
                }
            });
        }

        // Prevent accidental page close
        window.addEventListener('beforeunload', (e) => {
            if (appState.chatHistory.length > 0) {
                e.preventDefault();
                e.returnValue = '';
            }
        });

        // Auto-save user data periodically
        setInterval(() => {
            localStorage.setItem('lastActive', new Date().toISOString());
        }, 60000); // Every minute

        // Accessibility: Skip to main content
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Tab' && e.shiftKey) {
                // First tab press
                console.log('Tab navigation active');
            }
        });

        // Focus management for modals
        function trapFocus(element) {
            const focusableElements = element.querySelectorAll(
                'button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'
            );
            const firstFocusable = focusableElements[0];
            const lastFocusable = focusableElements[focusableElements.length - 1];

            element.addEventListener('keydown', (e) => {
                if (e.key === 'Tab') {
                    if (e.shiftKey) {
                        if (document.activeElement === firstFocusable) {
                            lastFocusable.focus();
                            e.preventDefault();
                        }
                    } else {
                        if (document.activeElement === lastFocusable) {
                            firstFocusable.focus();
                            e.preventDefault();
                        }
                    }
                }
                
                if (e.key === 'Escape') {
                    closeAccessibilityPanel();
                    closeEmergencyAlert();
                }
            });
        }

        // Apply focus trap to modals
        const accessibilityPanel = document.getElementById('accessibility-panel');
        const emergencyAlert = document.getElementById('emergency-alert');
        
        if (accessibilityPanel) trapFocus(accessibilityPanel);
        if (emergencyAlert) trapFocus(emergencyAlert);

        // ARIA live regions for dynamic content
        function announceToScreenReader(message) {
            const liveRegion = document.createElement('div');
            liveRegion.setAttribute('role', 'status');
            liveRegion.setAttribute('aria-live', 'polite');
            liveRegion.className = 'sr-only';
            liveRegion.textContent = message;
            document.body.appendChild(liveRegion);
            
            setTimeout(() => {
                document.body.removeChild(liveRegion);
            }, 1000);
        }

        // Enhanced error handling
        window.addEventListener('error', (e) => {
            console.error('Erro capturado:', e.error);
            announceToScreenReader('Ocorreu um erro. Por favor, tente novamente.');
        });

        // Prevent double-tap zoom on buttons
        let lastTouchEnd = 0;
        document.addEventListener('touchend', (e) => {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                e.preventDefault();
            }
            lastTouchEnd = now;
        }, false);

        // Add haptic feedback for supported devices
        function vibrate(pattern = 10) {
            if ('vibrate' in navigator) {
                navigator.vibrate(pattern);
            }
        }

        // Add vibration to button clicks
        document.addEventListener('click', (e) => {
            if (e.target.tagName === 'BUTTON') {
                vibrate(10);
            }
        });

        // Gesture support for mobile
        let touchStartX = 0;
        let touchStartY = 0;
        let touchEndX = 0;
        let touchEndY = 0;

        document.addEventListener('touchstart', (e) => {
            touchStartX = e.changedTouches[0].screenX;
            touchStartY = e.changedTouches[0].screenY;
        });

        document.addEventListener('touchend', (e) => {
            touchEndX = e.changedTouches[0].screenX;
            touchEndY = e.changedTouches[0].screenY;
            handleGesture();
        });

        function handleGesture() {
            const diffX = touchStartX - touchEndX;
            const diffY = touchStartY - touchEndY;
            
            // Swipe detection
            if (Math.abs(diffX) > Math.abs(diffY)) {
                if (Math.abs(diffX) > 100) {
                    if (diffX > 0) {
                        // Swipe left
                        console.log('Swipe left detected');
                    } else {
                        // Swipe right
                        console.log('Swipe right detected');
                        if (appState.currentView === 'chat' || appState.currentView === 'profile') {
                            showView('main');
                        }
                    }
                }
            }
        }

        // Console welcome message
        console.log('%c🌟 Facilita+ v1.0.0', 'color: #4F46E5; font-size: 24px; font-weight: bold;');
        console.log('%c✨ Powered by ORPHEO Platforms', 'color: #7C3AED; font-size: 16px;');
        console.log('%c♿ Desenvolvido com foco em acessibilidade', 'color: #10B981; font-size: 14px;');
        console.log('%c💙 ORPHEO Platforms', 'color: #3B82F6; font-size: 14px; font-weight: bold;');

        // Analytics (anonymized)
        function logEvent(eventName, eventData = {}) {
            console.log('Event:', eventName, eventData);
            // In production, send to analytics service
        }

        // Log app initialization
        logEvent('app_initialized', {
            version: '3.0.0',
            timestamp: new Date().toISOString(),
            userAgent: navigator.userAgent
        });
    </script>
</body>
</html>
